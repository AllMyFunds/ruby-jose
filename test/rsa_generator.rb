require 'thread'

module RSAGenerator

  MUTEX = Mutex.new

  @__cache__ = {
    1024 => {
      65537 => [
        "{\"d\":\"gadfR1T62a4q6gCbNxbVHwG6Phee3pk7HgTbAReYGnOB5Gq7T0MgdLlPBhLHX8mKMNHNarguesgLhlPNukR_iTMo7yu_rXCWQv8p8fLY7hlCMddsEOjA6BhjQBPd9gD-UrBXwEPrSLMD3zMZPT_3GpuVKIms9OzGOXTRPI_AnUE\",\"dp\":\"id_TAQXYdzT0cjDIko2WN1FcTjg1aUp-UVunZyM8w7JdO15qXlFMutsN82fpF3pJst3hEMW77-uds0hifuIxaQ\",\"dq\":\"aGEjz97XtHUWzztBhylO8VwCDC7tUJC1rCPSc85MDEdQklLEBMjn3YaLfqqRMAWiA1Cxp-LsHtzIJD9UgESHTw\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"rcPns7bi8r_3akrejl2VxwkIL9aa86qc4j49uPDduxUGuLicmt6DrJ-WdKYsB-Dkea-0Qp7nfnQAqV1lUmnNRqlcY8cx4-uZvRQ1bnTCpCFpzkq_XIBTuvEhZ3ekaus7rPRabEY2ii4pGEHwcXQ5SPTGESt9P4gH_XX8A8oYCM8\",\"p\":\"1WB4VKOkmf6I8eRE0MsT_0vS5krf8FR8lJru8F1c51YDEcPV7d_MCR1wfM9t2GZLIDNic5dAX82XkSRWP_OGOQ\",\"q\":\"0HnNj8DFYTVpwXYd_kpGGLE4goQQkSkEDkX4ldzQE_-xzsP7yJVUzQy7kHtUWYYq5tBEuQAd-QhBGytkPfRHRw\",\"qi\":\"s69j3vhGgS99DHklRs_lvc7g5-SgG3nwLAjbub-k-mwI67-RJEhMRozQxcASExkTlkk598xj50GvLZoPz6GyZQ\"}",
        "{\"d\":\"MSVtUIM5fGiSdkauIAPbITNlK1m38kGq0E8_Arya7NkhFZBCVcRErHFf_zSLo9U1SsCE6u9cCzxfVGAQoYo7xx_P0s7AGTsirk5zjV7InjP6PDaAITXMozmmRmoDm7JGEi1Ife8QY5hNcuuVQI98VQ5Vy5qODkXohmBVsyzUpLE\",\"dp\":\"1HOF05FJKkGH7DLwUQU_vJSbuQbtGg-baWfY9sewmoI-jByUmflzRWg0828YVBGHwCPUstnQsYV73rh6OZkTww\",\"dq\":\"yrW7aXGsEWP8ml31Y0fN498b3LP75gsAJYvIW2g0hCoTGQ0HXUhcVMTqMibBMuMZu5FCyLjtRXIRsGQZxWAA-Q\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"z3cLqDf3J9K77b-ZNzkfQ9zzCPfszkcWaK0x4WwM4sPUHcTuzUWLKrmle2ZuMHXR3JPOhbwUSrzIEDc5OokdoM17EmMW6X5fm1kvcaJ4kRRACqHUKpQrrWoeAgSBwIEUlHncQ2g9lVpZpH8_tTYfJSKR0fJxXts1Mxb1cQZEshc\",\"p\":\"62NAygXYiUIcCy2qfTIf8HA3HCflK9cmo70irG9uqT38CYSCtr3jUX8d0nHU4bv9kPhWwpoqrc87AwtFBq8AHw\",\"q\":\"4aHXqBcV0Wq14gTyZGF8KVyPsEa3hCrCEQjmVLDa1xEs42VNs-JshRGMR-scIAB45o5aDbq6rtxonwTo0-gvCQ\",\"qi\":\"t06zjKWTbUa9nRHDjPMbckDY_nps4VLzeYO1a5Yd9I5gwJcnk7frm8AiV3NS0BBSJ0sxYaDakZiNTZd_7GLbkQ\"}"
      ]
    },
    2048 => {
      65537 => [
        "{\"d\":\"JpFYjLbpwEvBrb1Q_-m89VGfn9mYaRsMu5Qn6QzevGtLWEcSjX6XoTrwsfcEAJ3YNdvAS5DCr5Ybw95s5tUxTXE5bdBx6ky-r1N15RloS4YbBGjAGFl4Nee75MVwO-vEJUXI6DsJbqJROvkJh4f2tcZqBKWKTUoMq8WPRsgjQ6L9eITkcWHgQhCQ6hoTsyY0HMftRAUKPtv_xjxV8nssHA5AfKjycG-p-3IJC6qRwCKWJd-jOhGb2XME2h59U2XJybFgUOe5lCSMsL_8YugcHO1gYFi2lMcijpMFo0-z0Wx5TG5ICHdwPDlNkshExCinjQYA3Q8Jlp7bFyj5v_f4UQ\",\"dp\":\"GY_ygOknlH7wCt_MHKAa1UYwpQei4W2Ie2eC8EDn8s0CaSG29r2yXPmPZ1y_mL8XuRQnbAyXUQDCo30oL05pnP06YsZgJd2WrMy-k1_VeaXLfpjpu_Ib-BhDB2iGKAA3QL4hvuNeeQKt2hrf_dcvnMQgCq4XhHVw5qA5ZIonz3s\",\"dq\":\"E2Ras_nvfCcsDdeixGUPRfRbPh1UocYQTc7mtFjmQTcRJd-SZP4WB_bfPMusz5Y0nS7-uMrHWtVIyKUi3gtobKdqADSWYdmrqSr7236XrNT92waVL2wG0tAX8hIrLYPl6yD3qdiCCHYlngJ_Iup4TOmsztjftUeuhw57l2lPoQk\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"scnIwb3Q6p4Gi5rsl88cF2IQH9uPLuXC7tHXAK4n9j2vuARfX4uykYDxqj9Ph1EiejEyY2Emc0rp8QWdKpZbjpqVnh0hPFDnRzgBKZnIl6itfCbCYheZR25lGSSpW9DS6YIsS-o0t6m1ulrxQ0gVthXIxlpWlznRiis8GB5Jtwxe5KPrIElD_LgTKt63D1K9F7AlGzqF5DzQBcpvDqXJaPqeF9e52vGe2izyTkOkMRVyOiE26mOCV0_MIR-yZHL_X-a2zX61580St4ACAVPPApKiYWWgBsqWA2KTCWsCOKnOt_2uv8m5Wzdya7JMGRJ7sx-RycDP5PWpL89eyG4VAw\",\"p\":\"6GMB6Z2myJXgUT5tmjuRici94tHeKP6cozWHCmY1U84LFaF5ALK7PRyrw8dJhpOHsbqhA8zXZXVH2RKPjXZSAnHTnHQnfzompmJ8XURRcbdifIRBXvyfmCxtye-mPxS_XkKi4_NDqYkjpUJfsUcuMsWKsx-BYwDvobjoRSjiwus\",\"q\":\"w9qGYmq78youg4THJtpPkvEYXC5YaibSvoTQRgzOVdHG_Yr_bjTnvUitakdQBImdRL-SeX2UXH_OrthpOVVuROAwRgKMTm5xz5RCYEd0APkfhbfP8srKLpa78-6wzwEfKuspVnHaFgVeVZ0uGHG_MkyuthhS7tCIS1AmvLEtgEk\",\"qi\":\"MOmIHInsINIeKemm8nXdAQ2VLUeXH_VSmsJbJjCn2374_e6BzA0rxe24o_EBxhs_oRicVwNdFKu-g78pNmBAA2rn9f6wpQvb090EgOHdG1VN5CqCLWH6V00LWEecZRGpMyGNWbJOfBv3CynenuSChNPvyvnMenDKFRVtH3Oyfww\"}",
        "{\"d\":\"iQMNuDX5DU5cF4_q5-lAfyw55BlJ7tmnNr-KKwjEdN1vetjcRAkBgSl49-BXFftWN5WVvlFBjqMyy5E0F5s2iKd0qToX1yNRAUhWzbhS3yKUDHWp-efS7Uk9pzeUFdt8YfkbMteoFzgXEn8_unq8Xre4MvmYzAXP46IlJH6HYBKN-9MwL9mEPf9E9CntTVbfEHSNuWBkhX_qJ2qBTizDMpHpgpmViPibF_BelBJXPU5OYBkpj95Q3gw0bXSByXWzyT7uVzEdzBM1G4loqTJ3nVVNv8QLwiV18I64LE3WSfag10KJiKDhsIg-GnNR-nMmNGdPiqR4ZYhnAGvZUmDiDQ\",\"dp\":\"cRElYUTXK5e6SiWfLA8i-kuRFD6TF34fCDi88y3w4vXx9rWvr_1rpHmfP5PAnmvka4FOQgyy0K2WZuHxMgEliRIyJcfPVp-e3pVnnhVh3e5nVeG7lxzzuZh2AqzjcGHOnXBLpel1plstnoOdwEWHxrbEnWQGkCVYvw_Ns-I0PnM\",\"dq\":\"IB5gUL2JIG_QFXTf-j6FyNWqQxASrx3_SrZrcCYdBjF1aIkVwPiDRXyKB0SXwsVA4Hsl_El-uTlL3hP6Oxm7QRkBrEB4vv_BEFH5jF3Dxh2E6hWI4fa5nrx1__f_kv1LUXqL6tp4tKOQG1ylD3Oxp4xJ6cQ7oJ3c5ZVNgDfAILM\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"2D1YivTRgW4CkGuhek7A9By8OwfV-wD7CiiIuuPwq_Cp6Hba37v5FX2sbHyZi-dwpUswnDB0sJGy_fWakRT3yAJ_rjhkLQYPoC4dS9eWDteCebgehrcqhs3XbNAf8X9TkA2xhQ0hhjfuKYd2zaQsBtsiDakJIMIY2oxOlSDdVpGo0pUmFg28V6vaEex27YYzO-Bh1d5qZh7P0eMMNsOXTrQiaVPLcWxOn75FaOR6p-8Fp_OVJyq5G_4u9HMGebeqMmM3tA_vrdhdCe4Ize40W_K-KRGFdBRtWYTNjFon7TR8Og_zrV0om4aK764V70_Rt4k60y3ZxHb4uMfCsvXwDQ\",\"p\":\"_Nw7Leh4RuyhxEykJCasXjpmyGBvuvaqhik5rmGdCEM0Amhyl5v0lxqZCutt2mN0ZeiNIOX3ZgucRvjPqjNqFGMFbLcuHp5JYbqSARMR0ta3pQSmyiGxNWulj3T7HEDhTgtHT7kY3nQP-9FRlPJCV1Ow5Arm2fSHcSiRC4WGxYM\",\"q\":\"2uy1WK8i2fpQ67Xp-_dfznZ1Hc1n18LTlOgDy7_rBxGJCf9eYyiptUj3ZRymOt5PVet1NxLMLh158-h4vyq-IAKhOL3qofJsQm45aagWd-aFRkaHZteZRCK9GkdlcPClQXep4OmLF5-jGmfLtgCdfmM-b--HkiGkIPeWtjO3Dy8\",\"qi\":\"68NmHkMtry__Ahq8CICxQJmJT_kDNt5doSnQqob799Ct1AW2avHfh8D3le3mEZCUN32xCShaGhXY23VM0O3VesayImVZGjaa-dlmC_ONlB4HCHpoZjs2dS53tqIASJZ52KzHHmu1RdYujQm8yB4CNxU8kAFiobO2yJ_E6YVPsZI\"}"
      ]
    },
    3072 => {
      65537 => [
        "{\"d\":\"n4Wa7v5GdWtzqS18it_Ru4dDI20uY3h3O4nH5oxynU45HN5Q1jjOxu62uypLn2CxX7IZXsI0wYP5TpDD3fKr_WZ0gzFzNpewuDwOCYdwikLX6mtUDXKCwCEUVg5fCIp-nrN8IMDFtlVrbNPrSKFw70H5WsRhuWANehud3EDBdOrEuRABU9FhbV3ncOunnlMjgjdSE-K128t8GR1nccvxUH7YgeW3x_nVLevVXDBobS4VKIoRiyvRts367OuEmrUxefJa7XMCEvfDn5MlxfHI0DbVf3UoJ_LwiYu8tMAmVVaRG_Gmk7lc6YNi7X7NMWFn-zP_Q8goElgdcJvfGC-Ro67iU3CsLwLbI3KpIkLTEkFBFeIyDTtHYdf2hBZM5x_OCl9dHp8B9nsJpwHlyfzVGisqLosKtrqrVXHVSx90SyQqt5fgId9jeIAjigm_SrpoVWpgwLBYa2wnd9a1J4AD1MTLt-K4hw9EHzFwVzoO-2naJ6FWx2xujz49EOe2u_EZ\",\"dp\":\"HaiIo_LXxw0h9JgkGWLuIOhz0yklnTVCstfqsj49JPwSzEdt9t8NrZdZgXWDBc1__a1wWJ5ECnPGHcHHbHKf-3O-Cpeok1NLrHBu6fvWKs8jtzhG6u657fJd0i8uj9ZJHtSEcx_CjsUxf0QRSIxi-gfwCoyeaylm7aAfnwocyFC9EUdHqkkV3gZEOhRspPOP5fSxRQXUHPG0WLxdu_Rvc3-kV3kG3Hf7DDQQ_u9P_dlf45GA8mgqryw3d1geMtKZ\",\"dq\":\"zKZ1axNVUcuPE9RR7WKHJiDxhIkjzxHFxoMIDy5H0B6TpWsTZIz4KlfsqFuMaoAXguaeTTZMOUCE8o8SR-TDu1L27X_te2Cv2rHJMHoZCvWx0fiFQ89JBp4Srxq3mG9GyUIxwIdTZ4CRCOKe--j9uiEwejX2tWJ6OZu_RtbO7Q3ITU92VbcidKUKzr1Oy0ccpR3QgJUOJIhSlxJSm6ksrLdO_dBGx-Li2N1wmmefCb0Wa-AIwzN__MH7qaYgpBer\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"yynV7QMYundfHfMBHHZ70gSAJSxt6EOr02ke1KfvsPbIoWurO0NwWGuQbwsc233DOCsRRZxaBfGOottF4AZCDmOx-584um5yplAEPxaXUCWATWJ_xH5r5btmO8f4COwpQdzDLIOqkVSbFjMNY9fzTsVk_2_AjLyo76xNoG0yOCWoX1diiSE-OVYsUeazX13KK0kB1O6KwrY1LxgivYIfUFRWoCGPApHwAnj5dUzrQgN769aPXvYhHZgBNVjsPHF5UVvB24Zyj2epwo-kGPJLT6nqeQdgjaqP-IMWEFJ19dM73xFF6aRo_GtrQSTyBN4RYNvhkhseHma2ibVJkpqwqE8M2J94mjLs2t0HNrQ_L_UDRdT9bGP7sGQrUKIZFfStnu4ZZ9pgIBLMzPEg_cVZA3cKkqr1CYOew6O-x8FnoZuv7xN85_hCTfLNmp2gODo76fmb4lmNbaM8-es08OenoJFuUDyYMh3Ke3bfJwyBVx4RO5W4AfQ2wruSRGmVyBb7\",\"p\":\"5nZTjAja2CSyh66skx-dCxD1m3_PoKgIgIjhKnZcAfrFywKOm-z0bLI1FQkPVoXaGBVPCrP0Xbm4DGGH3k8srrSWQlfgxBQfzV-2-4fOLe8UKl9-6eRYC4sSaSykXSZVwG3bcZaqDjKjMYX_DCGd-K6nv06F6Yh4p8OyBvkifo8RHqrbcP91UaeO2nE9aovk2XgdbyBkIPVLSiT8EFXSOaTQUYKHiuwiXZUxUv7QYWo6jMKkJeotwLXV-kfsa5it\",\"q\":\"4a0bQGwRlFvkRjFUIPr1THRaZTHr2a_o4OPpw_jPi-WaP3G3tavKiDrahYIPZ2U_i2D9KR4pwU_FkaIFsKj5QCEFwtqrxasYdbA7oDKg4-ny6Y4Ug4lkTwfKDsfjlX8A9n9edm98oggKRn7N2ZF3sqHhCymlDF0GADB9PT-6i4YEWMBEzgJNCxTBbHw8QY0nFUSn5muJNJ5J8LHsxWvQdAKMfXvA0WvgVH9ajmYaW_dMrHL2NKox8USmlCSogJtH\",\"qi\":\"COwZUbFsoTFEpkoBMUUyNWzXwXhO5WD9UbGX5dFTp01yqCWH_sX25HNhDSoHpcs1w4U1T6jD6E3JdDGe2Qe3Y00Rw4qEtplHshXLCSjMCnZPL2IV7MBETNhsOTu5J86DRuKzpX5VmLPuSRUsiQZAtlDBtzHiTiZ2Vab9QUuC7WPF-i5H1BRsYyOmzSvkMjDIY3DcE_JJCUcNPqgT3llXeT0LdYWJk5I_IL6_aPu9FKKTMhWNy4KRKYjwwocGYpzt\"}",
        "{\"d\":\"CY19rHyn48wN9Zs7wg87z86AHQvIMx7L7bm59GqU0ValKk2CwTJjEDWY-6yOQFxOa-1CoJYL7DQLrumaLUgN8O4UzOXqpcWGVGCnKs4SKXT-7xaEGRocwxpUJIWHuHVbGerQOEq7JypiXym_DGuVKu5dWl60v8dPrMb4PQxKNuy6uHwnrIhcmlPGYHHXhxmK9wb4T2sYXKnSBN0ihYj4354lH-5kdXuZ2iWkWEZtppP3ZSf6l31JNbvglRKT3shcKlLMIhhcss6YxD1TKxBKV2hPBJtgzPCMd8AmtrYguZ37MOtUvo4XIOrvu1Aps5nL_YQGkGcVF-APil-dohLP6m1xPf7Rp4qzfbGSvOlfxiajzmDhobbfkiVDyuyhyHuEb2ZNCz3ssGaeCyAj1TbYmSQCddKkHKb3oYYKh4obeNPoeAb4iOgRz4IT7vETSv3ZIljWKpyBDYIT5ynuBGwTneCz1f5ZpR94TQTBKZIdkLj1WoG7sHLKJr4tsoH_GQRh\",\"dp\":\"SkLqgDb_LlgvCWFnKi_fvHgdePPVwXRzdsA7c9j8DfmYPeoZ_EShfx4Lvnw0_lR-aM4V2FWzEW2OaA5U99UfpqQKwCaQQhsR_8eZShTdLoZ9PafUrYU9aFJYu7iP3vi2jcCCR7CD5NdHPobye_44g-QXNKN_mm_nw_TRU64P7Y254eaRApnkwmo05UMXnY2b5t2HqkilDK--2cnTewHZTGGl9hBoDC4LYxx5gIrhJPTY_x53rrKJ5_D5xKeVaq0f\",\"dq\":\"F0l12bXTcW_Q3Hu503OzM8NsoTV5hAMqPmCalFKGnpR96CtdiNrEjEihYG3gQIOgRtaLlxBDHb9qM8H2u1VZPhiS6TcwZqBf-vJ7qF5usWGeFgyMIg89h5Ur_Ds4bqNcX0nDvgGbwhDQznarrHMB9cu6m3N-V4BDEMt6vthFJJKBwvE0Uvtz1L_pyuwgP3_PFON4UPUc8EhsixixZzXm8UCsmaYtRWwN_8O2_gPG7twFLQdok_ZEbfoUcXQ6J29x\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"vTKdNBeMTB9kKUAWElW1z3BnojnPfBfBOF9J5Pa7_XuXKq4nC-zVawvt1x2f-92OSrWyASKfFM8E8rchGmY3UInX2Jl038CRl8nPN-AzVWxDd_M_y99XcFc1hlt2wQfvO6RBiT3FgRYDXni0lQ2pZCa0URU1CEhfAsH0ZYsfRZ-7FacK9i1scPtV0IPT0fkyaJeVa-C6RpIeEgmzTlTSyYlhQN8mcM1t6nQVz3mIyAkggK_A1EeKBTCv2KI6v2sTVYrLixgIE-EgVCmDzuWTxSJjfqcuGjCwkgIhv5LpihWI_-rsMNBHuAb76vN2PlbsRXHJmywMTygihiedptOH1yALIhWZy_sRY0Cy5m2iL4F-lGdspmiVdm2lfoGlWwrjW0TRX6o8GJvhDHQA-X_h6aEq4HYDE7oMn2rWaEwR1WCzbqb8r7zJWSyWv1xaLQ902FBu3pT12R1M9mCyyljTrlrKbYccgLTAeZ0-FYDqG2j36yUv2OB1MxPsuAdJ9U1r\",\"p\":\"3pEbcWyxlu7FhIqqbX9QcZq1ixuaHb0RwBlQLuFoeVoiw7NXKfowxNykj89WypMG4yXPWZzhYCh1OxI3cmo5erLsvneU3TXRplGQf1of6BEW9ZrarodwZSWUn3dlddbVB05VNPXwTg2yxwYKgCeTeePebrYAg60XqJPySPmjcFlvmYtcWQ4ZgHNIqPUQaMUSU8UGkMYrrub59yJIGjFWY8GC5Ob7r9qgMMsyP0sS_68OaT2rvuMyH7aXxFszDtDb\",\"q\":\"2Z5I52vWW-OcbdMJ73upZM81gD23tD5I2DSZpB_K5B2DQTSXR3La6ggEtg2H_YNny_nPXOV36jCxq2QAVuGvvqbbvoQhEMiSuEmKV-dvcFVAyCLUw-27sfsXvfjxSKvSr6kWANo1y2H4mZaVHymXs7IwX7dZpxlkBaQ2jFtnl3DYTOlzUmFr4CjUs2A61Ia4OQnvvCfJAOOqtcKefsnMNP1BwT368qbM7MCMPLJ24QsP2CjL9Zc_tS-nD2R67pKx\",\"qi\":\"Fe9bFsLInWWdC8ohc0JlT2v-ilu2iNcE0-GAwKdA6ul9ZHKgiDSsCkDNucnVpE_Gy1EUE2WxGkcdexUHL79o-EcBIOZR3IMp-YIpOjXId_wIzFK4wcWoj4zPZ7t7qRZWbtIoMWiCFI6FU5Np1j50bgN3H7FzJN_qkgjKDFSOJ2qf-31Low4okFo5RdsIpqiDnMK57NZcQKQ-JuL8ucx7VfGvk4Od9yGsFkcEV6J4AGqak1cBzOd7eUfcz9Wr1nHi\"}"
      ]
    },
    4096 => {
      65537 => [
        "{\"d\":\"bt9hGyZt2Eq8pa5Zb5tFXE-H74pLZ7YLCmvdpN4x-Y2bpQ0Yhcfzv95o52I_1KZDlIujKa4G2gQev-6ohyLfuoo5xn4ggkQBuGsmIro4Rz_WzHaV40OE5-_gYGRPDsAhX5hyb8VQ3jQrhzosoy9iNJPBeIgTZ1NX7CSxdipCTa1wNywYVCKQOGFTnUYJurmfENMHyQ7tDAoJt_DNGrKi3VZynDyHe_P_E0ZXnF2bOmYJ4ETax0BvML_q8-uXJP1SEm77PPLdniOvD_Nx0vnIiNLo8WXnwqRaikwYDLQwj7weMCUoluneurN96DLnjwS6SfDEXkqNRuJFpJGaz3I_B5FDUBMqFJECTSoho_Ihsc4odkDCMA9nE545MITfzShVw2ypOAI_0015NLez5QkGydNDok4vxz0sqwiNAOb-7nHKgerOLfJGFQ075wGwbusQX-QfKcg0mzeAIQVomWBP-0xiuz2BeqUYdbjcj5PV_SONMVK0X2GL_SqqG5jT54I3x53HNbHMqpRy4-TMf0q4CUuzfLklBaOur9tNptWNpvx0Ee1FaUHvt9qjNJFeZhu7ejXZPKk2jopWARiLan0Yqm452vODKGbmdJyRbdZe6sk9N1p3d_yBD_OhlFr2lKEhzfDbw2L2RBMkQ78os_9Z0CgT-HSaB4CfJqkDFSLQA6k\",\"dp\":\"sGa3Z9uLfCc-hAkEfs17sMcLqCFnolSohrPMgCMi-Gu9X7ATkvUsr5BBHAOfxqtHsKeVBgZ8k0ajbcGfvYWEJEBfIBB0wqEqWAHyslkjBNTYy1U-yK5T640NsuSpGIo-f06xJtD_dvn0PG2momawloA7cl70m4l5JITgMljllO5V29qsKraPZ0jXffAVYu1j-gQXsmgdXaS9TKZKU7JAIAlni17fYI3uoBbKSSQG_erFRS4cqo2Sh3FDYkhKKRSnlBPFpkwuDg3TXuFP4u4P8gOG2rD8AhykV15YtOLDFqEwE4XLBN0iAW-K9deSFBG78KrQ4sZXbZv5wyCYW8gaMQ\",\"dq\":\"HT0VSBIjcCM8ld-Se705SQuq5Akm5Sor9z8U4qDcg8_Q5tFh7y4e_ceJQ9JCFBN-MNUX6FMcpRhRfsA1X3XV1e302vn5DAKZCafFKT2u2hjL7AJeLOvsy68S_TopNOTb0qTfxeqecJv0udIT_uW8dJXXSJDPg19vg885Akq49JSr63Tf8DQzZYHdxuHH4ntZmyTgTPzfpb6B0FMs0sh5uYCj01v42H8tPbrZTIhcLTTEY6qX9jI__NSBf_WSMJizzrg0oVDjJmRHcdX_KWvVGzJfvcxhogqvrboBHQUnZAY2jIGYWD43Pzi9-NekdH3q3dI-2eOsuDe0qGSPF2Gumw\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"y1fJvkm9TtKv3bD9E6Ycy-Umot56olj_RcjHrnjVt0vY3-y5xR1tMW7cqlrc9b3kT0Hkjotb25IUk1TeWy3_1pPA53vjShDK3DNIwdU84_1K1nkIKnqBovzV8vAMhBlj6GZ9M06fcIajn1rafAYryU80vmcavwqynDzn6ANFKUcCXlafwoZJENFkA64JQuv_GbvjfNwuNwq-jJOdj_srFZoR0JFe7VOnnn5AS5M33YHM1irONezgCuIJr0PdjzZs-kpnRsC7MHszl8RLEWCNseEXtxcl7i06WUEUpwnhkQxSVMKjVzuS2kpApWjHk08ktp58N8HXdjfEybvv5xr4CgxVcSMj9sGYngFWtU4-U7c80uOi0UXKcmLoGGxOFPAtKfSduaTcGUZj9wOEPchEGNawPlhtTiWPVfKVYwXUJwYpANnV7XaOaW-F0G2V-YR1TfvceLGmsJllEpH7jdO7aZ-ToWsFsYSuFc2qE6GUAu4h4I3vwUCYTvxpkwnaJg98DyCxaTqbQwDvjB1hcQJozZhERoVIWu4k6RImwaIfaUr7pcgbfDThmEib9V_7qit0VUju_ve13zf_Ss_bRE6LeH2jnpN_ldPuGO1UCIDWMN3vIgfoA9QKKnGIjA06Fb26eXxmfa2BKuBV1S3COkn-jPeEEubMmqhQWqnqxH-IqA0\",\"p\":\"_nbHx30FaF8s6qFWo7xZ93NV3qAd8_z-7-LlvdKrLr0uczS3CQUXgzSzTPm12-jSCtCQgfsOWEgSr-yaKcWtj8fC4E6752us1kgYdOjnsPoU08Rfje97b2TkdPJRk3hakjfmVhyddWRczqZbPSgAWESex9iM-VzXu9SSL0sZoykgjxTqnj2LPCLLKUoVHRdYK4BB8PFZJwEwSWhlTWFYgG_WSMrpxeyFgs2Gjvqi7JTGy5fKC4HxyJMyX1yGnJh1bulhYYPJ35xLcU7s3Zf5sIBXzXdcM-OL_avLRsrlxbFUupE7-By1YyLTRH0AeKazJ6l1U0zqhRcqrySIehMlmw\",\"q\":\"zJIC0bbn_Ac8IQTY3zkszRw66lQXrSolexh2xKjgO86bXGkTuGWeGexZ1-vT5gZZDMxW1rt0n2oxcRxYNk901EstzaBKgEb6L4WHgJxUf5EYbX3qD9qo1X-RRGI8X5oiJh33Dq_Z04SBQ8XkNGld4yXLNaa-Dsi8VnAFSeuXXJxzVgd4zPqM58r104yiPOzKF2hbqTtnyfIMtC-x48a677-ll6YJCB4cSLNCGCaAAHaL4wCeUR8GSb_ykPzOdI84XbADwiqXxWOPBV5l0M0LQsDBuDwcRVFMkAU3NQ4IETUCLcEcED_UM7VB_ZWcy7pYfMOzes7ZmTI6pyD5I3fXdw\",\"qi\":\"89d0kzrgASvUyvGC7R4rVTB28nR1cfL20RWe0Coa3iQ6wuwWA_C60SKAm3ULZOyhdUCTqL5LodBcPLQ8yrjtNLzKbra-os-z_lTNDVs2qwYJpQfgZ4uhIITqNUkVyqBp-x3hO1sSrmFSqpHIeTFaKFEIaj9guU6UPjInrN4PF8TGYsMAOaW2FRn68M5u6AIqh3YcP0QoXlF1mMfR6BJVRoKN43STcDXQmArVU4WWPL1mw0_X_sk_9ycIKffZOnfjEJ2WllNBS9xeDG-HJMIaGBztlWouz4E8pVxDpKGOKMd1ucjvo8S0p-sicJ6fAN7ZGn1UmkvbBa4U5zbl0HiEMw\"}",
        "{\"d\":\"nuiPXd0H45zCKjdZztpQEN1ZaAdN_fxqS6PJrp7xrDPh2RyqOiz0aGRbaSzk7f5tWBUwO7r0-HClCRQ2MHOnGpigWZlOE85CZdOI7kwoh3Glz2QmZc1U_vIUgSnkVtuhlso0U8tL_EKsNaXLfqQOAmXy321AVfLmcl4WGCY_QMyLnMRF_yERYk8AlgTu0xkdufDPe_OzszwhfS1TsZqTBUM_jadqDf1ykaMsAfEwQovvvUVNScCxrrTepm1ynvna3ZElD7_g9mkX3VQn1w7xY2zWKzUGkUU1RgC8guFwT8-xFGiG15E7ZjUFTi46SuZiaZXdws1_sazYbT-rJR2HukKiXieKpEGztpKzPrztI9ZO3yoJP0JEpGXaXZ9dwUBYB6b_GvgHwK5IvSiTa3JvOnrijFxXF8Nvl1_bxnABVnNBRhZn86vJRHSIH97XvbePiwylr-8Ui6Wak0JpHd4WCU2F_30uAdFljd0CqNr3ILpSQJMNtjv4Lr9QsRCcMrCUhwYvAOZrpLkwzkbTEHnQoJCzLhFTu8aAAcSTIw-dxqbbzzWf8MQn8HCYvBncwy7damtq-yORWqpWknqIGZGOgip6GtYIfdlH8KBvgFVy7AXoqwtAysgCOwfxfRqcpd8cLK04IIfv357OHmtBq5ytYAzjBsbmgG-jGWaTGsIiDnE\",\"dp\":\"nyt9R3YJodRMDLSJeX__5RQmLefaHsMngSZeTjwbc86K7wvAbCKhXaGpNxfglVYleASI8pQXw-Iw4GFkcnd3c-rp4cjG9n8xSYxBSiQlq1TIIy3cntWWwSUYQ6b1lifDnWfUrzn245-esOvKnWrKwrk1aNAgOGgL8HUjcJRhoBmVljzhjibz_awXCn3orp-QB-aZTVihes9jpDJiqcz4o3_XNUFmSK7MGbLb9aMgN5pkhnC8ImXCs-Oepo18dtGXLh5imvpMhuW5TjWh82CVcpo9aobG0MLRdIU8jgs6ufsEGYcE1GPYLgzCnKH-jSKUFT3Js991Zvjs33S_JXb7yQ\",\"dq\":\"RtnQE-XyoqzrtmKTjzmZnXKti6V8Cq0PZMTh27U4sCkyb-zh0Zk6o3LCgbRx4BsmJdu_4E9syHAvcktW_rw223qobHliTwm2O9Nt76rEk2XI49T1y9INqxgyB92P1qRzoYG658nU1cgo8ms7kYj1kBeBToc59cDA8uRpZyVfPueC3IAKdL8llhUME5mMSwJ6YtOHU350huwzxUHKuPu8D3njom4IHLp7doDgqIPPuEe56YH0SgKn63ITZPSwAHbNFENvb00HIhbESDQkTGWhcrM7abVX4TpX-LA4iOWSq8-_vkK13C5Uthanr-IkUyreKcjvpGBAhngHKTkw8uJnCQ\",\"e\":\"AQAB\",\"kty\":\"RSA\",\"n\":\"s-vXrPFz3V05tRzJnWIByr94KHHHYthVe4N2Upw4bhjbGw5XBmnq8erC4WRJF_2JvSYKifntIUm_F0zJ0fxBpJ3eWl0GpLZU7OOfbwc518oZ-86dcsyZKy8Ie91DBU1-C3i7VlxWIoSNA-fAOfQI9mFijHB-wGA46scak78pDUWMi-GQ9e8m14nNb2kVQFP_9d_V4aXRvheKd7w_c89aV5IpO4eTuHAyqZ5qaBbm1odxRoZYy4rHIm7rOTDIYuBWSx_Qu-YWBsIWbxJ4UialzORg247ExtghspW4UuPqpxTSWEIJYqqrAZbw0DOfv7_ye-q3CptYe0o8WAw-arSVTH0bIN9z4RxiOIm-sf4IgThshWdCY1bNf9VmyF_jKww_hdkHPIQSyk44ZIPdf_45rMUakmr93tZzs2g_FhObwQ4H0uWex74UbwwDXZgw9zUC1s3biFuLd1HxKuDM9OrQ9e_b7HK7RWboOnme1h2QI31lJhmuAmJENE05URRPecmFfa7yN4PXsiC6riBE3qc_vJnqXdkZR_m3vPfkFxAun_Ysp5_EJGbU5OnIR_AnwEKa3xATGtW8v5ErPDyO7xCZPBD9rmgVCMnd8w9gIamKCFne2Q2phJvJ3R16q8DrrOK6qfz5__mpwL-V9JVCt1DBCILp5PerzyYY_2eT4ridnP8\",\"p\":\"2d9a0hgOSTVKgKMA_UaRv8j3diCVZ2XqwN6YdlPAM43Oh3L4OwCZ_VUDc-Xias_S_c1vXS84M0EZ-7Pdpr1nr_tIdVg7UwgOdjRyLY1EYKl9uCkFCPp5e8XFIrZzVjFGZaPSSlh1UUpRKCQe3kZEzNjNoLei7PCmseTpmcdYpbm9wIZwarme5QEfDVLw0AOAFHtNzRkWGGsOaE5Fb0f_Rn1VQsIY9Zh1NGuATKWh_E2i6p04gX0P_Y2J0KOAECiKHgZ-sdQ_7tESdlG7ctYZ-HAcrzSSWbew3RgoRLHWzc7fuWVfQs_gW2SKJc4hmvu-vx2huSO6lwnadOwLJ5KL-Q\",\"q\":\"02hHxVOrP7oMcJ5BwfXAxRLSzdLd1AB9hu0yCDHX3_I68WZDBjx4nkwQFwTYAUVOYgVhuEmg49oMbictYxvOHHT5CxIHRyUgL9pxg29V5wnLPjcIWrliqjzav_vM85ocgjr7NzVvj7MnDW3dLrickWz4qE-K2dkyEVABoGlAzrTR2DgG9LCJgHk93-WEgWhbEUW5fxyUUeBUH2UHcfjhCLHCIvxYtOwwIAh5svCSKQVLNxr34yzrUw58YCKO0Nn5gjh0lhSuiqDrVaYqbpv4ozsMOdHc7H3MqH5EFK2RVguahyNvFjG1jMpP_GKDoOHZ6uqeBDHZYd2Qxm0exW9-tw\",\"qi\":\"qDoXVt3AJqWnE7wuwv0lDfGWlHaR7mg2taV52dFjD5VvNbqR2SVKle17yIcITDI1Ip_dCJRbTqyHnK8Dgczf2eoMunEs36CcDZ8P8xnVerjI1t9sLheS3NBv69WXBa59sNeFUGGj8RiJkmKU2yH7goph9LeTP6H8lrNUgVZaoNH4fuqRhue_DNoRGf4XzTWqeoOK_Tde-l2OC-M_cK_j-ysCkilTMWPSogBkfsNCNlvcIZiislTGlQquAkySxs3uafh85zzMWaJOh-u-4Cvj8VEjtFGPZYEaTVweXipfKz8pfAwkYm_31PGGrelwsPFOUFegBAAprfHPXk47LWI0GQ\"}"
      ]
    }
  }

  def self.cache(&block)
    generate_key = ->(modulus_size, exponent_size = nil) do
      if modulus_size.is_a?(Array)
        if modulus_size.length == 2 and modulus_size[0] == :rsa
          modulus_size = modulus_size[1]
        elsif modulus_size.length == 3 and modulus_size[0] == :rsa
          exponent_size = modulus_size[2]
          modulus_size  = modulus_size[1]
        end
      end
      exponent_size ||= 65537
      key = nil
      MUTEX.synchronize {
        if @__cache__[modulus_size] and @__cache__[modulus_size][exponent_size]
          key = @__cache__[modulus_size][exponent_size].shift
          if key.is_a?(String)
            key = JOSE::JWK::KTY_RSA.from_key(JOSE::JWK.from(key).to_key)
          end
          @__cache__[modulus_size][exponent_size].push(key)
        # else
        #   puts "modulus_size:  #{modulus_size}"
        #   puts "exponent_size: #{exponent_size}"
        end
      }
      key || JOSE::JWK::KTY_RSA.__minitest_stub__generate_key(modulus_size, exponent_size)
    end
    return JOSE::JWK::KTY_RSA.stub(:generate_key, generate_key, &block)
  end

end
